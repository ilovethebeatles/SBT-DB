# Отчет по базе данных Yellowbrick DataWarehouse

## a.История развития

Yellowbrick Data Warehouse была создана в 2014 году в Калифорнии Нилом Карсоном, Джимом Доусеном и Марком Бриникомбе. Основной идеей было создание СУБД, оптимизированной для аналитических запросов на больших объемах данных с высокой скоростью обработки. Система быстро нашла своих пользователей среди крупных компаний благодаря своей способности обрабатывать транзакции и аналитические запросы в режиме реального времени. С течением времени компания привлекла значительные инвестиции(в числе ее инвесторов есть такие крупные компании как Samsung и BMW) и расширила свои возможности, добавив поддержку облачных технологий.

## b.Инструменты для взаимодействия с СУБД
С Yellowbrick можно взаимодействовать через вэб-интерфейс, в нем можно смотреть на состояние таблиц и кластеров, создавать их, писать и выполнять sql-запросы и многое другое:
![image](https://github.com/ilovethebeatles/SBT-DB/assets/106533857/2bf790f2-ed85-41ce-a17f-227bc500f0a6)
![image](https://github.com/ilovethebeatles/SBT-DB/assets/106533857/a59832a3-eab8-406e-af3b-ce47c065cadb)
![image](https://github.com/ilovethebeatles/SBT-DB/assets/106533857/345b25f3-835d-4316-9957-31969098a41f)
![image](https://github.com/ilovethebeatles/SBT-DB/assets/106533857/ea1bf536-92f7-44c2-8b35-87af2357ce10)
![image](https://github.com/ilovethebeatles/SBT-DB/assets/106533857/77e2328f-9716-418a-b832-df87d06fa66f)


## c. Какой database engine используется в вашей СУБД?

У Yellowbrick свой database engine, он состоит из 4 компонент: storage engine(хранение структурированных данных), execution engine(эффективное перемещение данных через граф запросов), workload manager(распределение ресурсов), query compiler(преобразует планы запросов в машинный код). 

## d.Как устроен язык запросов в вашей СУБД? Разверните БД с данными и выполните ряд запросов. 

Yellowbrick Data Warehouse - это платное программное обеспечение, однако можно запросить бесплатный период:
![image](https://github.com/ilovethebeatles/SBT-DB/assets/106533857/74da6cc4-2414-4310-96a7-7b1748c392c0)

![image](https://github.com/ilovethebeatles/SBT-DB/assets/106533857/beeefc06-0bb6-4a64-b464-1e95730fdbdb)
Переходим на сайт из таблички со скрина выше и вводим логин и пароль из таблички
![image](https://github.com/ilovethebeatles/SBT-DB/assets/106533857/52c885d3-ea5c-4dc7-a622-a3cbf7e5a012)
![image](https://github.com/ilovethebeatles/SBT-DB/assets/106533857/a90be4c2-8c87-496b-9057-9a422c59bc5e)
В пробном аккаунте уже есть примеры баз данных
![image](https://github.com/ilovethebeatles/SBT-DB/assets/106533857/0340c3c7-bbc2-4f8f-9640-55b8e2f0f1bd)

Выполним запрос выборки в специальном окне:
![image](https://github.com/ilovethebeatles/SBT-DB/assets/106533857/07d8db7e-f3d4-4422-9e1a-58ff0958f713)

Вот его результат:
![image](https://github.com/ilovethebeatles/SBT-DB/assets/106533857/7a3f4f72-ce51-41dc-b72d-c37979ea6c26)

Учитывая сложность запроса, отработал он довольно быстро

Выполним запрос на создание таблицы

![image](https://github.com/ilovethebeatles/SBT-DB/assets/106533857/837bc06c-7cd7-48a1-bc55-7362bda75900)

Как видим, у нас появилась таблица student
![image](https://github.com/ilovethebeatles/SBT-DB/assets/106533857/f6688a52-8398-496a-ae52-a20d7ac98776)

Вставим в нее что-нибудь

![image](https://github.com/ilovethebeatles/SBT-DB/assets/106533857/0ca4a2ec-6015-4056-8e4b-83006e64f36a)

Посмотрим, что в нашей таблице

![image](https://github.com/ilovethebeatles/SBT-DB/assets/106533857/bcffe520-fe3f-43b2-8552-91478fc4c41b)

Удалим эту запись из таблицы

![image](https://github.com/ilovethebeatles/SBT-DB/assets/106533857/3d4229a9-9c8c-4dfb-a91d-acec02fa24c9)


## e. Распределение файлов БД по разным носителям?
Архитектура хранения данных в Yellowbrick представляет собой гибридную систему, которая адаптируется как к локальным (on-premise), так и к облачным (cloud) средам:

-Локальное хранение (On-Premise)

NVMe SSDs и BBFS: Данные постоянно хранятся на серверах в NVMe SSD с использованием специализированной файловой системы под названием BBFS (Big Block File System). BBFS является полностью асинхронной и хранит метаданные файловой системы в индексах, расположенных в оперативной памяти.

ParityFS: На BBFS базируется другая файловая система - ParityFS, которая реализует кодирование с избыточностью n+2 на уровне файла, позволяя тем самым терпеть до двух одновременных сбоев. Если узел выходит из строя, его файлы виртуально переназначаются оставшимся узлам, которые "лениво" восстанавливают файлы при их чтении.

-Облачное хранение (Cloud)

Object Store (например, Amazon S3):

В облачной версии Yellowbrick данные сохраняются в объектное хранилище, такое как Amazon S3. Рабочие узлы используют специальные коннекторы к объектному хранилищу, основанные на пользовательском асинхронном HTTP-стеке.

Локальные SSD как кэш: Локальные SSD используются в качестве кэшей с записью через обход (write-around cache): когда узел записывает данные в шард, он напрямую записывает их в объектное хранилище, оповещая другие рабочие узлы. Кэши используют модифицированную политику вытеснения LRU (Least Recently Used) с устойчивостью к сканированию, а шарды назначаются рабочим узлам с использованием хеширования rendezvous.

То есть файлы в Yellowbrick распределены по носителям в зависимости от конфигурации (локальной или облачной).

## f. На каком языке/ах программирования написана СУБД?

Yellowbrick написана на С++.

## g. Какие типы индексов поддерживаются в БД? Приведите пример создания индексов.

Yellowbrick не поддерживает индексы. Разработчики Yellowbrick называют это преимуществом продукта: нет необхожимости создавать вручную индексы, т.к. каждая колонка уже внутренне проиндексирована.

## h. Как строится процесс выполнения запросов в вашей СУБД?

 Процесс выполнения запросов в Yellowbrick строится следующим образом:
![image](https://github.com/ilovethebeatles/SBT-DB/assets/106533857/48f363e5-8d9d-439a-8cc7-dfa197a80457)

-Подача (Submit):

Запрос поступает на управляющий узел и проходит первоначальную проверку на корректность SQL-синтаксиса.
Здесь применяются правила управления рабочей нагрузкой (используется Workload Manager, далее WLM), такие как ограничение одновременных запросов.

-Разбор (Parse):

Запрос преобразуется в абстрактное синтаксическое дерево (AST).
Запрос получает необходимые блокировки для выполнения. Время ожидания блокировок отслеживается.

-Планирование (Plan):

Генерируется план запроса на основе информации о таблицах и типах запросов.

-Сборка (Assemble):

План запроса превращается в артефакт, который может быть скомпилирован. Происходят дополнительные оптимизации.

-Компиляция (Compile):

Собранный запрос компилируется в двоичный код, который может быть отправлен рабочим узлам.
Эта фаза может занять значительное время.

-Получение ресурсов (Acquire Resources):

Ресурсы для выполнения запроса выделяются. Статистика компиляции доступна для WLM.

-Выполнение (Run):

Запрос отправляется на рабочие узлы и начинает выполняться на одном или нескольких узлах.
Применяются правила WLM во время выполнения.

-Ожидание клиента (Client Wait):

Запрос отправляет строки клиенту и ждет, пока клиент получит или запросит все строки.

Завершающие стадии (Completion states: Done, Error, Cancel):

-Done: 

Запрос завершается после получения последних результатов клиентом.

-Error:

Запрос завершается с ошибкой.

-Cancel:

Запрос отменяется пользователем.

На этих стадиях можно применять правила завершения, например, для логирования.

Перезапуск запроса (Restart states):

Запросы могут быть перезапущены пользователем или системой на основе специфических правил или команд администратора.
Запросы перезапускаются с состояния сборки (Assemble) и могут проходить через несколько циклов выполнения.


## i. Есть ли для вашей СУБД понятие «план запросов»? Если да, объясните, как работает данный этап.

Да, есть, в основе планировщика Yellowbrick лежит планировщик PostgreSQL, т.е. он работает по такому же принципу, однако команда Yellowbrick внесла некоторые улучшения, например:

-Осведомленность о MPP: Планировщик учитывает особенности MPP-архитектуры, включая оценку стоимости обмена данными по сети. Это позволяет эффективно распределять работу между узлами.

-Планы MPP для всех стандартных примитивов: Планировщик поддерживает создание планов для всех стандартных операций, таких как соединения (joins), агрегации, сортировки, подсчеты уникальных значений и т.д., а также учитывает распределение данных (хешированное, реплицированное, случайное).

-Замена алгоритма соединений: Введен новый оценщик и модель стоимости для алгоритмов соединения, использующие метаданные, гистограммы, подразумеваемые равенства и вывод уникальности.

-Замена алгоритма выборки: Улучшено определение селективности сканирования.

-Поддержка коррелированных подзапросов: Поддержка различных форм коррелированных подзапросов.

-Инкрементные статистики: Поддержка использования и комбинирования инкрементных статистик с использованием алгоритмов больших данных.

-Авто-параметризация запросов: Поддержка автоматической параметризации запросов для повторного использования планов.

-Поддержка разделения: Включение итераторов разделов в планы запросов.

-Новая иерархия типов данных: Соответствие типов данных другим корпоративным базам данных и уменьшение необходимости в явном приведении типов в выражениях.

-Позднее связывание представлений (Late-bound views): Представления оцениваются при доступе, позволяя объектам базы данных, на которые ссылаются представления, быть удаленными и созданными заново.

-Новый интерфейс EXPLAIN: Улучшенный интерфейс для объяснения планов запросов.



## j. Поддерживаются ли транзакции в вашей СУБД? Если да, то расскажите о нем. Если нет, то существует ли альтернатива?

Да, Yellowbrick поддерживает ACID, используется уровень изоляции READ COMMITED.


## k. Какие методы восстановления поддерживаются в вашей СУБД. Расскажите о них.

Снимки состояния данных: Yellowbrick может создавать транзакционно согласованные снимки всех данных в базе данных в любой момент. Эти снимки создаются с низкой нагрузкой и занимают очень мало места.

SQL-ориентированное резервное копирование и восстановление: Резервное копирование и восстановление реализованы как SQL-операции, что позволяет использовать высокую пропускную способность движка Yellowbrick. Восстановление также реализовано как SQL-операция и аналогично массовой загрузке данных.

Также см. пункт e. про ParityFS.

## l. Расскажите про шардинг в вашей конкретной СУБД. Какие типы используются? Принцип работы.

В Yellowbrick используется вертикальный(поколоночный) шардинг.
## m. Возможно ли применить термины Data Mining, Data Warehousing и OLAP в вашей СУБД?
Да, Yellowbrick - это Data Warehouse, который создавался для решения задач современной аналитики, и все перечисленные понятия к ней применимы.

## n. Какие методы защиты поддерживаются вашей СУБД? Шифрование трафика, модели авторизации и т.п.

## o. Какие сообщества развивают данную СУБД? Кто в проекте имеет права на коммит и создание дистрибутива версий? Расскажите об этих людей и/или компаниях.

У Yellowbrick много инвесторов, одни из самых известных - BMW и Samsung

Имеют право на коммит Emtec, g2o, Next Pathway, Saarthee, Saxon, Systech, Virtusa.

## p. Создайте свои собственные данные для демонстрации работы СУБД. 

см.пункт d

## q. Как продолжить самостоятельное изучение языка запросов с помощью демобазы. Если демобазы нет, то создайте ее.

Демобазы есть, при создании аккаунта у меня уже были заполненные таблицы. В частности, есть база данных tpc-ds (https://www.tpc.org/tpcds/) которая используется для тестирования скорости и работы систем баз данных, к ней есть запросы(например здесь: https://github.com/Agirish/tpcds), один из таких я запустила в пункте d. На примере этой базы данных можно посмотреть как созданы таблицы, позапускать готовые запросы, попытаться их отредактировать, но в демобазе особо нет нужды, т.к. синтаксис запросов такой же как у Postgres, и для обучения языку запросов сгодится любой курс по Postgres.

## r. Где найти документацию и пройти обучение

Документация есть на официальном сайте: https://docs.yellowbrick.com/?_gl=1*1hphsbt*_ga*MTM5ODY5ODM5NS4xNzEzODk0OTkz*_ga_YBP5HZ98RC*MTcxMzk2OTM2Ni43LjEuMTcxMzk3MzM0MS4wLjAuMA..

Также есть туториалы на их Youtube-канале: https://www.youtube.com/@YellowbrickData

## s. Как быть в курсе происходящего

Разработчики Yellowbrick регулярно выпускают статьи об улучшениях,которые можно найти в разделе Resourse Library: https://yellowbrick.com/resources/

Также информацию о событиях, связанных с Yellowbrick, можно найти во вкладке Events: https://yellowbrick.com/resources/events/
